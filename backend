import requests, json
import numpy as np
import pandas as pd 
url = 'https://inf551-project-48265.firebaseio.com/data.json'
df = pd.read_csv("Hack2018_ES.csv") 
df.rename(columns = {'estado':'Visit_Status'     , 'tiempo_demora':'Time_Delay', 'poblacion':'City',
                   'id_poblacion':'City_ID'      , 'edad_valor':'Patient_Age'  , 'cp':'Zipcode',
                   'latitude_corregida':'LAT'    , 'longitud_corregida':'LON'  , 'patologia':'Pathology',
                   'Fecha':'Date'                , 'id_tipo':'ID_Type'         , 'id_personal':'ID_Personal',
                   'nasistencias':'N_Home_Visits','menor':'Is_Patient_Minor'   , 'Geopoint_corregido':'Geo_Point'
                    }, inplace = True)
# df = df[0:10]
for index, row in df.iterrows():
    df.at[index, 'City']      = df.at[index, 'City'].replace('�', '')
    df.at[index, 'Pathology'] = df.at[index, 'Pathology'].replace('�', '')
    if np.isnan(df.at[index, 'Patient_Age']):
        df.at[index, 'Patient_Age'] = -1
    if np.isnan(df.at[index, 'Zipcode']):
        df.at[index, 'Zipcode'] = -1
data_dict = df.to_dict('index')
data_json = json.dumps(data_dict)
response = requests.put(url, data_json)
response
